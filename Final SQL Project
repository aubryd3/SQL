SELECT CustomerId, FirstName, LastName, Country
FROM chinook.customers
WHERE Country != "USA";


SELECT CustomerId, FirstName, LastName, Country
FROM chinook.customers
WHERE Country = "Brazil";


SELECT c.FirstName, c.LastName, i.InvoiceId, i.InvoiceDate, i.BillingCountry
FROM chinook.customers c

INNER JOIN chinook.invoices i
ON c.CustomerId = i.CustomerId

WHERE i.BillingCountry = "Brazil";


SELECT LastName, FirstName, Title
FROM chinook.employees
WHERE Title like '%Agent';


SELECT distinct BillingCountry
FROM chinook.invoices;


SELECT i.InvoiceId, e.FirstName, e.LastName
FROM chinook.employees e

JOIN chinook.customers c
ON e.EmployeeId = c.SupportRepId

JOIN chinook.invoices i
ON i.CustomerId = c.CustomerId;


SELECT e.FirstName, e.LastName, c.FirstName, c.LastName, c.Country, i.Total
FROM chinook.employees e

JOIN chinook.customers c
ON e.EmployeeId = c.SupportRepId

JOIN chinook.invoices i
ON i.CustomerId = c.CustomerId;


SELECT COUNT(InvoiceDate)
FROM chinook.invoices
WHERE InvoiceDate LIKE "2009%";


SELECT COUNT(*)
FROM chinook.Invoices
WHERE InvoiceDate BETWEEN '2009-01-01' AND '2009-12-31';


SELECT SUM(Total) AS Total_Sales
FROM chinook.invoices
WHERE InvoiceDate LIKE "2009%";


SELECT SUM(Total)
FROM chinook.Invoices
WHERE InvoiceDate BETWEEN '2009-01-01' AND '2009-12-31';


SELECT t.Name, i.InvoiceLineId
FROM chinook.invoice_items i

JOIN chinook.tracks t
ON i.TrackId = t.TrackId;

SELECT art.Name AS Artist, t.Name AS Track, i.InvoiceLineId
FROM chinook.invoice_items i

LEFT JOIN chinook.tracks t
ON i.TrackId = t.TrackId

INNER JOIN chinook.albums a
ON a.AlbumId = t.AlbumId

LEFT JOIN chinook.artists art
ON art.ArtistId = a.ArtistId;


SELECT  t.Name AS Track, a.Title AS Album, m.Name AS Media, g.Name AS Genre
FROM chinook.tracks t

JOIN chinook.albums a
ON a.AlbumID = t.AlbumId

JOIN chinook.genres g
ON g.GenreId = t.GenreId

JOIN chinook.media_types m
ON m.MediaTypeId = t.MediaTypeId;



SELECT e.FirstName, e.LastName,
ROUND(SUM(i.Total), 2) as 'Total Sales' 
FROM chinook.Employees e

JOIN chinook.Customers c
ON c.SupportRepId = e.EmployeeId

JOIN chinook.Invoices i
ON i.CustomerId = c.CustomerId

WHERE e.Title = 'Sales Support Agent' 
GROUP BY e.FirstName;
